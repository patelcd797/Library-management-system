<div class="container py-5">
    <div class="card h-100">
        <h1 class="my-3 text-capitalize px-3"><%= @book.title %></h1>
        <div class="d-flex mx-2 border-bottom  pb-2">
            <%= image_tag(@book.image, :alt => "rss feed", :class => "card-img-top minh-250 minw-200") %>
            <div class="card-body pb-0">
                <p class="card-text mb-1"><%= @book.description%></p>
                <p class="card-text mb-1">Author: <%= @book.author%></p>
                <p class="card-text mb-1">Price: <%= @book.price %></p>
                <p class="card-text mb-1">No of Books: <%= @book.no_of_books %> / Available: <%= @book.no_of_books_available %> </p>
                <p class="card-text mt-2">
                     <% if current_user.admin? %>
                        <%= link_to "Edit details", edit_book_path(@book), class: "btn btn-success text-nowrap" %>
                        <%= link_to "Remove book", book_path(@book), class: "btn btn-danger text-nowrap", data: {confirm: "are you sure you want to remove a book?"}, method: :delete %>
                    <% end %>
                    <% if @book.no_of_books_available > 0 %>
                        <%= link_to "Checkout a book", checkout_books_path(book: @book), class: "btn btn-success text-nowrap", method: :post %>
                    <% else %>
                        <% if !current_user.book_reserved?(@book) %>
                            <%= link_to "Reserve book", reserve_books_path(book: @book), class: "btn btn-primary text-nowrap", method: :post %>
                        <% else %>
                            <%= link_to "Unreserve book", reserve_book_path(@book), class: "btn btn-danger text-nowrap", method: :delete %>
                        <% end %>
                    <% end %>
                </p>
            </div>
        </div>
        <% if current_user.admin %>
            <% if @borrowed_users.size > 0 %>
                <div class="card-body">
                    <h5 class="card-title">Book check out users</h5>
                    <%= render 'users/users_list', users: @borrowed_users %>
                </div>
            <% end %>
            <% if @wishlisted_users.size > 0 %>
                <div class="card-body">
                    <h5 class="card-title">Wish list users</h5>
                    <%= render 'users/users_list', users: @wishlisted_users %>
                </div>
            <% end %>
        <% else %>
            <% if @book.feedback.size > 0 %>
                <div class="card-body feedback-section">
                    <h5 class="card-title">User Feedbacks</h5>
                    <% @book.feedback.each do |feedback| %>
                        <%= render 'books/feedback_card', feedback: feedback %>
                    <% end %>
                    <% @book.feedback.each do |feedback| %>
                        <%= render 'books/feedback_card', feedback: feedback %>
                    <% end %>
                    <% @book.feedback.each do |feedback| %>
                        <%= render 'books/feedback_card', feedback: feedback %>
                    <% end %>
                    <% @book.feedback.each do |feedback| %>
                        <%= render 'books/feedback_card', feedback: feedback %>
                    <% end %>
                </div>
            <% end %>
        <% end %>
    </div>
</div>
